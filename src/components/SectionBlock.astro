---
import type { CollectionEntry } from "astro:content";
import ArticleCardFeatured from "./ArticleCardFeatured.astro";
import { getArticlesWithUrls } from "../utils/articleUrls";

interface Props {
  title: string;
  description: string;
  moreHref: string;
  moreLinkLabel?: string;
  articles: CollectionEntry<"articles">[];
  lang?: "en" | "ua";
}

const {
  title,
  description,
  moreHref,
  moreLinkLabel = "See more",
  articles,
  lang = "en",
} = Astro.props;

const articlesWithUrls = getArticlesWithUrls(articles);
---

<section class="py-12">
  <div class="border-t border-gray-200 mb-10"></div>

  <div class="flex flex-col md:flex-row gap-10">
    <!-- Left 1/3 -->
    <div class="md:w-1/3 flex-shrink-0">
      <h2 class="text-2xl font-bold mb-3">{title}</h2>
      <p class="text-sm text-gray-600 leading-relaxed mb-5">{description}</p>
      <a href={moreHref} class="text-sm font-semibold text-accent hover:underline">
        {moreLinkLabel} →
      </a>
    </div>

    <!-- Right 2/3: 2×2 grid -->
    <div class="flex-1">
      {articles.length > 0 ? (
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
          {articlesWithUrls.slice(0, 4).map((article) => (
            <ArticleCardFeatured
              href={article.url}
              title={article.data.title}
              date={article.data.date}
              category={article.data.category}
              image={article.data.image}
              lang={lang}
            />
          ))}
        </div>
      ) : (
        <p class="text-sm text-gray-400">
          {lang === "ua"
            ? "Немає статей у цій категорії."
            : "No articles in this category yet."}
        </p>
      )}
    </div>
  </div>
</section>
