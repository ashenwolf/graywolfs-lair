---
import { getCollection } from "astro:content";
import Base from "../../layouts/Base.astro";
import SocialLinks from "../../components/SocialLinks.astro";
import ArticleCardFeatured from "../../components/ArticleCardFeatured.astro";
import SectionBlock from "../../components/SectionBlock.astro";
import { getArticlesWithUrls } from "../../utils/articleUrls";

const allArticles = (
  await getCollection("articles", ({ data }) => !data.draft && data.lang === "ua")
).sort((a, b) => b.data.date.getTime() - a.data.date.getTime());

const latestArticles = getArticlesWithUrls(allArticles.slice(0, 6));

const byCategory = (cat: string) =>
  getArticlesWithUrls(allArticles.filter((a) => a.data.category === cat).slice(0, 4));
---

<Base title="Головна" lang="ua">

  <!-- Hero -->
  <section class="bg-hero-bg w-full">
    <div class="max-w-5xl mx-auto px-4 sm:px-8 py-8 flex flex-col md:flex-row items-stretch gap-12">
      <div class="flex-1 min-w-0 flex flex-col justify-center">
        <h1 class="text-4xl md:text-5xl font-extrabold mb-5 leading-tight tracking-tight">
          Привіт, я Сергій Гуленок
        </h1>
        <p class="text-gray-700 text-lg leading-relaxed mb-3">
          Розробник програмного забезпечення, мандрівник.
        </p>
        <p class="text-gray-600 text-base leading-relaxed mb-8">
          Я пишу про код, подорожі та те, що спадає на думку.
        </p>
        <SocialLinks />
      </div>
      <div class="flex-1 min-w-0 flex items-center justify-center">
        <img
          src="/assets/images/2026/02/sergii-and-denzel.jpg"
          alt="Сергій і Дензел"
          class="w-[420px] aspect-[2/3] rounded-2xl object-cover photo-glow"
        />
      </div>
    </div>
  </section>

  <!-- Latest Articles -->
  <section class="max-w-5xl mx-auto px-4 sm:px-8 py-16">
    <h2 class="text-2xl font-bold mb-8">Нові статті</h2>
    {latestArticles.length > 0 ? (
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
        {latestArticles.map((article) => (
          <ArticleCardFeatured
            href={article.url}
            title={article.data.title}
            date={article.data.date}
            category={article.data.category}
            image={article.data.image}
            lang="ua"
          />
        ))}
      </div>
    ) : (
      <p class="text-gray-400">Статей поки немає.</p>
    )}
  </section>

  <!-- Category sections -->
  <div class="max-w-5xl mx-auto px-4 sm:px-8 pb-16">
    <SectionBlock
      title="Розробка ПЗ"
      description="Занурення в код, архітектуру та ремесло створення програм."
      moreHref="/ua/category/software-engineering"
      moreLinkLabel="Дивитись більше"
      articles={byCategory("software-engineering")}
      lang="ua"
    />
    <SectionBlock
      title="Подорожі"
      description="Розповіді та фото з різних куточків світу."
      moreHref="/ua/category/travel"
      moreLinkLabel="Дивитись більше"
      articles={byCategory("travel")}
      lang="ua"
    />
    <SectionBlock
      title="Життя"
      description="Роздуми, думки та те, про що варто написати."
      moreHref="/ua/category/life"
      moreLinkLabel="Дивитись більше"
      articles={byCategory("life")}
      lang="ua"
    />
  </div>

</Base>
