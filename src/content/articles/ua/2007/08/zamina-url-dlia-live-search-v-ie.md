---
title: "–ó–∞–º—ñ–Ω–∞ URL –¥–ª—è Live search –≤ IE"
date: 2007-08-30
tags: ["life"]
lang: ua
category: life
---

–û–¥—Ä–∞–∑—É –º–∞–ª–µ–Ω—å–∫–∞ –≤—ñ–¥–º–∞–∑–∫–∞: —Ç–µ, —â–æ –Ω–∞–¥–∞–ª—ñ –æ–ø–∏—Å–∞–Ω–µ –º–µ–Ω—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–ª–æ –≤–∏–∫–ª—é—á–Ω–æ –ø–æ —Ä–æ–±–æ—Ç—ñ. –°–∞–º —è IE –Ω–µ –∫–æ—Ä–∏—Å—Ç—É—é—Å—å ‚Äì –ª–∏—à–µ –û–ø–µ—Ä–æ—é —Ç–∞ –§–∞–π—Ä—Ñ–æ–∫—Å–æ–º üòâ

–ù–µ –¥–∏–≤–ª—è—á–∏—Å—å –Ω–∞ —Ç–µ, —â–æ —Å–∞–±–∂–µ–≤–∞ –∑–∞–¥–∞—á–∞ –∑–¥–∞—î—Ç—å—Å—è –≤–µ–ª—å–º–∏ —ñ –≤–µ–ª—å–º–∏ —Ç—Ä–∏–≤—ñ–∞–ª—å–Ω–æ—é –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –≤—Å–µ –Ω–µ –∞—Ç–∫ –ø—Ä–æ—Å—Ç–æ. –ú–∞—î—Ç—å—Å—è –Ω–∞ —É–≤–∞–∑—ñ URL, –ø–æ —è–∫–æ–º—É –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä, —è–∫—â–æ –≤–∏ –≤–≤–µ–¥–µ—Ç–∏ —è–∫—É—Å—å –º–∞—è—á–Ω—é –≤ _Location Bar_ (–Ω–∞–ø—Ä. –Ω–∞–±—ñ—Ä —Å–ª—ñ–≤, –∞–±–æ –Ω–µ—ñ—Å–Ω—É—é—á–∏–π –¥–æ–º–µ–Ω). –¢–æ—á–Ω—ñ—à–µ –≤–µ–ª–∏–∫—É –ø—Ä–æ–±–ª–µ–º—É —Ü–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–ª—è IE6. –î–ª—è Internet Explorer 7 –≤—Å–µ –≤–∏—Ä—ñ—à—É—î—Ç—å—Å—è –ø—Ä–æ—Å—Ç–æ ‚Äì URL –¥–ª—è –∑–∞–∫–∞—á–∫–∏ –º—ñ–Ω—è—î—Ç—å—Å—è –ø—Ä–∞–≤–∫–æ—é –∫–ª—é—á–∞ —Ä–µ—î—Å—Ç—Ä—É:

```
HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\SearchScopes\{0633EE93-D776-472f-A0FF-E1416B8B2E3A}\URL
```

–ú—ñ–Ω—è—î–º–æ –ø—Ä–æ–ø–∏—Å–∞–Ω–∏–π —Ç–∞–º –º–∞–π–∫—Ä–æ—Å–æ—Ñ—Ç—ñ–≤—Å—å–∫–∏–π Live search –Ω–∞ —â–æ—Å—å —Ç–∏–ø—É:

```
http://www.google.com.ua/search?hl=uk&q={searchTerms}&meta=
```

–¥–µ _{searchTerms}_ ‚Äì –º–∞–∫—Ä–æ—Å, –Ω–∞ –º—ñ—Å—Ü–µ —è–∫–æ–≥–æ –ø—ñ–¥—Å—Ç–∞–≤–ª—è—î—Ç—å—Å—è –≤–≤–µ–¥–µ–Ω—ñ –≤ —Ä—è–¥–∫—É –±—Ä–∞—É–∑–µ—Ä–∞ –ª–µ–∫—Å–µ–º–∏. –Ü –≤—Å–µ –û–ö. –ê –æ—Ç –≤ IE6 —Ç–∞–∫–æ–≥–æ –∫–ª—é—á–∞ –Ω–µ–º–∞. –Ü —Ç–∞–º –≤—Å–µ —Ä–æ–±–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ –¥—É–ø—É. –°–∞–º–µ —Ü–µ–π —Ä–æ–º–∞–Ω—Ç–∏—á–Ω–∏–π —à–ª—è—Ö —ñ –±—É–¥–µ –¥–∞–ª—ñ –æ–ø–∏—Å–∞–Ω–æ‚Ä¶

–î–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è URL –¥–ª—è –ø—ñ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ _Address bar_ –≤ —Ä–∞–∑—ñ, –∫–æ–ª–∏ IE –Ω–µ –º–æ–∂–µ –∑–Ω–∞–π—Ç–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–æ —è–∫–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ (–≤–∏ –Ω–µ –≤–∫–∞–∑–∞–ª–∏ –π–æ–≥–æ, –∞ –¥—Ä–µ—Å–∞ –Ω–µ –º—ñ—Å—Ç–∏—Ç—å –Ω—ñ—è–∫–∏—Ö –ø—ñ–¥–∫–∞–∑–æ–∫, –Ω–∞–ø—Ä. —É –≤–∏–≥–ª—è–¥—ñ –ø—Ä–µ—Ñ—ñ–∫—Å–∞ ‚Äúwww.‚Äù) –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è COM-–æ–±‚Äô—î–∫—Ç, —â–æ —Ä–µ–∞–ª—ñ–∑—É—î —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å [IURLSearchHook](http://msdn2.microsoft.com/en-us/library/ms631445.aspx). –¶–µ–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–∞—î –ª–∏—à–µ –æ–¥–Ω—É —á–ª–µ–Ω-—Ñ—É–Ω–∫—Ü—ñ—é: [Translate](http://msdn2.microsoft.com/en-us/library/ms631448.aspx). –í –∫–æ–º–ø–ª–µ–∫—Ç—ñ –∑ IE6 –π–¥–µ –≤–ª–∞—Å–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ü—å–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É, —è–∫–∞ –≤—ñ–¥–∫—Ä–∏–≤–∞—î —Å—Ç–æ—Ä—ñ–Ω–∫—É _[auto.search.msn.com](http://auto.search.msn.com)_. CLSID –æ–±‚Äô—î–∫—Ç–∞, —è–∫–∏–π –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏–º–µ –∑–∞ –ø–æ—Å—Ç–∞—á–∞–Ω–Ω—è URL –ø—Ä–æ–ø–∏—Å–∞–Ω–æ –≤ –∫–ª—é—á—ñ `HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\URLSearchHooks`. –ü–æ –∑–∞–º–æ–≤—É—á—É–≤–∞–Ω–Ω—é –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –æ–±‚Äô—î–∫—Ç –∑ CLSID `{CFBFAE00-17A6-11D0-99CB-00C04FD64497}`. –î–ª—è —Ç–æ–≥–æ, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –≤–ª–∞—Å–Ω–∏–π URL –¥–ª—è –ø–æ—à—É–∫—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ –π–æ–≥–æ —Å–≤–æ—î—é —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é.

–î–ª—è —Ü—å–æ–≥–æ —Å—Ç–≤–æ—Ä—é—î–º–æ –∑–≤–∏—á–∞–Ω–π–∏–π –ø—Ä–æ–µ–∫—Ç ATL:

![Customizing IE live search - Create ATL Project](/assets/images/2007/08/ie-hook-1.jpg)  
–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑–∞–ª–∏—à–∞—î–º–æ –±–µ–∑ –∑–º—ñ–Ω. –î–∞–ª—ñ –≤ —â–æ–π–Ω–æ—Å—Ç–≤–æ—Ä–µ–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—ñ —á–µ—Ä–µ–∑ Class Wizard –¥–æ–¥–∞—î–º–æ _ATL Simple Object_ ‚Äì –∫–ª–∞—Å, —è–∫–∏–π —ñ –±—É–¥–µ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—î—é —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É [IURLSearchHook](http://msdn2.microsoft.com/en-us/library/ms631445.aspx).

![Customizing IE live search - Create ATL Simple Class](/assets/images/2007/08/ie-hook-2.jpg)  
–î–∞—î–º–æ —Ü—å–æ–º—É –∫–ª–∞—Å—É —è–∫–µ—Å—å —ñ–º‚Äô—è. –í–∫–ª–∞–¥–∫—É ‚ÄúOptions‚Äù –º–æ–∂–Ω–∞ –Ω–µ —á—ñ–ø–∞—Ç–∏ —ñ –∑–∞–ª–∏—à–∏—Ç–∏ –≤—Å–µ –ø–æ –¥–µ—Ñ–æ–ª—Ç—É.

![Customizing IE live search - ATL Simple Class Wizard](/assets/images/2007/08/ie-hook-3.jpg)  
Class Wizard –∑—Ä–æ–±–∏–≤ –¥–ª—è –Ω–∞—Å –ø—Ä–∞–∫—Ç–∏—á–Ω–æ –≤—Å—é –±—Ä—É–¥–Ω—É —Ä–æ–±–æ—Ç—É —ñ —Ç–µ–ø–µ—Ä –º–æ–∂–Ω–∞, –≤–ª–∞—Å–Ω–µ, –¥–æ–ø–∏—Å—É–≤–∞—Ç–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ.

–§–∞–π–ª –∑ –æ–ø–∏—Å–∞–Ω–Ω—è–º –∫–ª–∞—Å—É (–≤ –Ω–∞—à–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ Searcher.h) –¥–æ–≤–æ–¥–∏–º–æ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –≤–∏–≥–ª—è–¥—É:

```
// Searcher.h : Declaration of the CSearcher
#pragma once
#include "resource.h" // main symbols
#include <..\PlatformSDK\include\comdef.h>
#include <shlobj.h>

// ISearcher
[ object, uuid("A548953B-21A1-490F-A189-0F9FD714BDE2"),
  dual, helpstring("ISearcher Interface"), pointer_default(unique) ]
__interface ISearcher : IDispatch { };

// CSearcher
[ coclass, threading("apartment"), vi_progid("IESearchHook.Searcher"),
  progid("IESearchHook.Searcher.1"), version(1.0),
  uuid("94D618D6-E6E7-4EE9-B1B7-24C0B2327853"), helpstring("Searcher Class") ]
class ATL_NO_VTABLE CSearcher :
  public ISearcher,
  public IURLSearchHook
  {
  public:
    CSearcher() {}
  
    DECLARE_PROTECT_FINAL_CONSTRUCT()
  
    BEGIN_COM_MAP(CSearcher)
      COM_INTERFACE_ENTRY(ISearcher)
      COM_INTERFACE_ENTRY(IDispatch)
      COM_INTERFACE_ENTRY(IURLSearchHook)
    END_COM_MAP()
  
    HRESULT FinalConstruct() { return S_OK; }
  
    void FinalRelease() {}
  
  public:
    STDMETHODIMP Translate(LPWSTR lpwszSearchURL, DWORD cchBufferSize)
      {
      LPWSTR wszURL = new WCHAR[cchBufferSize];
      ::LoadStringW(_AtlBaseModule.GetModuleInstance(), IDS_URL404, wszURL, cchBufferSize);
      wcsncat(wszURL, lpwszSearchURL, cchBufferSize);
      ZeroMemory(lpwszSearchURL, wcslen(wszURL));
      wcsncpy( lpwszSearchURL, wszURL, cchBufferSize);
      delete [] wszURL;
      return S_OK;
      }
    };
```

–î–∞–ª—ñ —Å—Ç–≤–æ—Ä—é—î–º–æ —Ä–µ—Å—É—Ä—Å –≤ String table –∑ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–æ–º _IDS\_URL404_ —ñ –∑–º—ñ—Å—Ç–æ–º —Ç–∏–ø—É: _[http://www.google.com/search?q=](http://www.google.com/search?q=)_ (—Ü–µ –ø–æ—à—É–∫ –ø–æ –≥—É–≥–ª—é) —ñ –∑–±–∏—Ä–∞—î–º–æ –ø—Ä–æ–¥—É–∫—Ç. –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—é COM-–æ–±‚Äô—î–∫—Ç–∞ Visual Studio –∑—Ä–æ–±–∏—Ç—å –∑–∞ –Ω–∞—Å, –∞–ª–µ –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ —Ü—é dll-–±—ñ–±–ª—ñ–æ—Ç–µ–∫—É –Ω–∞ —ñ–Ω—à–æ–º—É –∫–æ–º–ø—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–º–∞–Ω–¥—É:

```
regsvr32 IESearchHook.dll
```

–î–æ —Ä–µ—á—ñ, –ø–æ –∫–æ–¥—É —â–µ –ø—Ä–æ—à—É –∑–≤–µ—Ä–Ω—É—Ç–∏ —É–≤–∞–≥—É –Ω–∞ —Ä—è–¥–æ–∫:

```
#include <..\PlatformSDK\include\comdef.h>
```

–°–ø—Ä–∞–≤–∞ –≤ —Ç–æ–º—É, —â–æ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ –≤ Visual Studio .NET (2003) —î –¥–≤–∞ —Ñ–∞–π–ª–∏ _comdef.h_ —ñ –≤ –æ–¥–Ω–æ–º—É –∑ –Ω–∏—Ö –Ω–µ –ø—Ä–æ–ø–∏—Å–∞–Ω–æ GUID –¥–ª—è [IURLSearchHook](http://msdn2.microsoft.com/en-us/library/ms631445.aspx). –Ü —Ç–æ–¥—ñ –ø—Ä–∏ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó –≤ —Ä—è–¥–∫—É:

```
 COM_INTERFACE_ENTRY(IURLSearchHook)
```

–º–æ–∂–µ –≤–∏–¥–∞–≤–∞—Ç–∏—Å—å –ø–æ–º–∏–ª–∫–∞ —Ç–∏–ø—É:

```
d:\Work\Other\IESearchHook\Searcher.h(49) : error C2787: 'IURLSearchHook' : no GUID has been associated with this object
```

–¢–æ–º—É –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π _comdef.h_ –ø–µ—Ä–µ—Å–≤—ñ–¥—á—ñ—Ç—å—Å—è, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Å–∞–º–µ —Ç–æ–π, —è–∫–∏–π –ª–µ–∂–∏—Ç—å –≤:

```
PATH_TO_VISUAL_STUDIO\Vc7\PlatformSDK\Include\
```

–ù—É —ñ –Ω–∞—Ä–µ—à—Ç—ñ –æ—Å—Ç–∞–Ω–Ω—ñ–π –∫—Ä–æ–∫ ‚Äì —Ü–µ –ø—ñ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—à–æ–≥–æ COM-–æ–±‚Äô—î–∫—Ç—É –∑–∞–º—ñ—Å—Ç—å –µ–∫—Å–ø–ª–æ—Ä–µ—Ä—ñ–≤—Å—å–∫–æ–≥–æ. –î–ª—è —Ü—å–æ–≥–æ –≤ –∫–ª—é—á—ñ

```
HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\URLSearchHooks
```

–≤–∏–¥–∞–ª—è—î–º–æ –ø–∞—Ä–∞–º–µ—Ç—Ä, —ñ–º‚Äô—è —è–∫–æ–≥–æ —î CLSID –ø–æ—Ç–æ—á–Ω–æ–≥–æ –æ–±‚Äô—î–∫—Ç—É, —â–æ –≤–∏–¥–∞—î —Ä—è–¥–æ–∫ –ø–æ—à—É–∫—É —ñ —Å—Ç–≤–æ—Ä—é—î–º–æ –ø–∞—Ä–∞–º–µ—Ç—Ä –∑ —ñ–º–µ–Ω–µ–º, —Ä—ñ–≤–Ω–∏–º CLSID –Ω–∞—à–æ–≥–æ –æ–±‚Äô—î–∫—Ç—É, –æ–±–≥–æ–Ω—É–≤—à–∏ –π–æ–≥–æ –≤ —Ñ—ñ–≥—É—Ä–Ω—ñ –¥—É–∂–∫–∏. –î–ª—è –ø—Ä–∏–∫–ª–∞–¥—É –≤–∏—â–µ ‚Äì —Ü–µ –±—É–¥–µ ‚Äú{94D618D6-E6E7-4EE9-B1B7-24C0B2327853}‚Äù.

–û—Ç —ñ –≤—Å–µ. –ó–∞–ø—É—Å–∫–∞—î–º–æ _Internet Explorer_ —ñ –Ω–∞—Å–æ–ª–æ–¥–∂—É—î–º–æ—Å—å –ø–æ—à—É–∫–æ–º –≤ _Google_ –∑–∞–º—ñ—Å—Ç—å _Live Search_ üòâ –¶–µ–π —Å–ø–æ—Å—ñ–± –≤–∏–ø—Ä–æ–±—É–≤–∞–Ω–æ –¥–ª—è _Internet Explorer_ –≤–µ—Ä—Å—ñ–π 6 —Ç–∞ 7. –ü–æ —ñ–¥–µ—ó –º–∞—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –ø–æ—á–∏–Ω–∞—é—á–∏ –∑ 4-–≥–æ, –∞–ª–µ —Ü–µ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è–ª–æ—Å—è.

–ó–≤—ñ—Å–Ω–æ, –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é Translate —Ç—Ä–µ–±–∞ –±—É–¥–µ –¥–µ—â–æ —É—Å–∫–ª–∞–¥–Ω–∏—Ç–∏, –∞–ª–µ —Ç–æ –≤–∂–µ –±—ñ–ª—å—à —Ç—Ä–∏–≤—ñ–∞–ª—å–Ω–∞ —Å–ø—Ä–∞–≤–∞.

–ó–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é —Ü—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è –≤—á–∞—Å–Ω–æ —è –º—É—à—É –ø–æ–¥—è–∫—É–≤–∞—Ç–∏ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –¥–≤–æ—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤:

1.  [Google Answers: Change Autosearch URL in IE6](http://answers.google.com/answers/threadview?id=305908). –ê–ª–µ —Å–ø–æ—Å—ñ–± –æ–ø–∏—Å–∞–Ω–∏–π —Ç—É—Ç –Ω–µ –∑–æ–≤—Å—ñ–º –ø—Ä–∞—Ü—é—î üòâ –û–¥–Ω–∞ –∑ –ø–æ–º–∏–ª–æ–∫ ‚Äì —Ü–µ —è–∫—Ä–∞–∑ –æ–ø–∏—Å–∞–Ω–∏–π –≤–∏—â–µ –ø—Ä–∏–∫–æ–ª –∑ _comdef.h_
2.  [–Ø–∫–∏–π—Å—å –∫–∏—Ç–∞–π—Å—å–∫–∏–π —Ä–µ—Å—É—Ä—Å](http://www.renpeicheng.com/html/2007-03/1653.html). –¢–∞–º –¥–æ–±—Ä–µ, —â–æ –±—É–ª–∞ –∫—É–ø–∞ —Å–∫—Ä—ñ–Ω—ñ–≤ —Ç–∞ –±–∞–≥–∞—Ç–æ –∫–æ–¥—É —ñ —è —ñ–Ω—Ç—É—ñ—Ç–∏–≤–Ω–æ –∑–¥–æ–≥–∞–¥–∞–≤—Å—è –≤ —Ü—ñ–π –∫—É–ø—ñ —ñ—î—Ä–æ–≥–ª—ñ—Ñ—ñ–≤ –≤ —á–æ–º—É –±—É–ª–∞ –ª–∞–∂–∞ üôÇ
